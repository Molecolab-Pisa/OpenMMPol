if (WITH_HDF5)
add_test(NAME NMA_AMOEBA_MMP_HDF5_convert
        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
        ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_mmp.json Testing/NMA_AMOEBA_MMP_HDF5 ./app/ommp_pp)

add_test(NAME NMA_AMOEBA_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_mmp.json
                          Testing/NMA_AMOEBA_MMP_init.out)
add_test(NAME NMA_AMOEBA_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/NMA_AMOEBA_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/summary_AMOEBA.ref)

add_test(NAME NMA_AMOEBA_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/NMA_AMOEBA_MMP_HDF5.json
                          Testing/NMA_AMOEBA_MMP_init.out_HDF5)
add_test(NAME NMA_AMOEBA_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/NMA_AMOEBA_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/summary_AMOEBA.ref)
                          
add_test(NAME NMA_AMOEBA_XYZ_HDF5_convert
        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
        ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_xyz.json Testing/NMA_AMOEBA_XYZ_HDF5 ./app/ommp_pp)

add_test(NAME NMA_AMOEBA_XYZ_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_xyz.json
                          Testing/NMA_AMOEBA_XYZ_init.out)
add_test(NAME NMA_AMOEBA_XYZ_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/NMA_AMOEBA_XYZ_init.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/summary_AMOEBA.ref)

add_test(NAME NMA_AMOEBA_XYZ_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/NMA_AMOEBA_XYZ_HDF5.json
                          Testing/NMA_AMOEBA_XYZ_init.out_HDF5)
add_test(NAME NMA_AMOEBA_XYZ_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/NMA_AMOEBA_XYZ_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/summary_AMOEBA.ref)

add_test(NAME NMA_AMBER_MMP_HDF5_convert
        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
        ${CMAKE_SOURCE_DIR}/tests/NMA_amber_mmp.json Testing/NMA_AMBER_MMP_HDF5 ./app/ommp_pp)

add_test(NAME NMA_AMBER_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amber_mmp.json
                          Testing/NMA_AMBER_MMP_init.out)
add_test(NAME NMA_AMBER_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/NMA_AMBER_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/summary_WANG_AL.ref)

add_test(NAME NMA_AMBER_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/NMA_AMBER_MMP_HDF5.json
                          Testing/NMA_AMBER_MMP_init.out_HDF5)
add_test(NAME NMA_AMBER_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/NMA_AMBER_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/summary_WANG_AL.ref)

add_test(NAME NMA_AMOEBA_MMP_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_mmp.json
                          Testing/NMA_AMOEBA_MMP_energy.out )
add_test(NAME NMA_AMOEBA_MMP_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMOEBA_MMP_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/ENE_0_AMOEBA.ref
                           1e-06  1e-06)

add_test(NAME NMA_AMOEBA_MMP_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/NMA_AMOEBA_MMP_HDF5.json
                          Testing/NMA_AMOEBA_MMP_energy.out_HDF5 )
add_test(NAME NMA_AMOEBA_MMP_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMOEBA_MMP_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/ENE_0_AMOEBA.ref
                           1e-06  1e-06)

add_test(NAME NMA_AMOEBA_MMP_energy_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_mmp.json
                          Testing/NMA_AMOEBA_MMP_energy_EF_1.out tests/N-methylacetamide/EF_1.txt)
add_test(NAME NMA_AMOEBA_MMP_energy_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMOEBA_MMP_energy_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/ENE_1_AMOEBA.ref
                           1e-06  1e-06)

add_test(NAME NMA_AMOEBA_MMP_energy_EF_1_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/NMA_AMOEBA_MMP_HDF5.json
                          Testing/NMA_AMOEBA_MMP_energy_EF_1.out_HDF5 tests/N-methylacetamide/EF_1.txt)
add_test(NAME NMA_AMOEBA_MMP_energy_EF_1_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMOEBA_MMP_energy_EF_1.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/ENE_1_AMOEBA.ref
                           1e-06  1e-06)
endif ()
add_test(NAME NMA_AMBER_MMP_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amber_mmp.json
                          Testing/NMA_AMBER_MMP_energy.out )
add_test(NAME NMA_AMBER_MMP_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMBER_MMP_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/ENE_0_WANG_AL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME NMA_AMBER_MMP_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/NMA_AMBER_MMP_HDF5.json
                          Testing/NMA_AMBER_MMP_energy.out_HDF5 )
add_test(NAME NMA_AMBER_MMP_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMBER_MMP_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/ENE_0_WANG_AL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME NMA_AMBER_MMP_energy_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amber_mmp.json
                          Testing/NMA_AMBER_MMP_energy_EF_1.out tests/N-methylacetamide/EF_1.txt)
add_test(NAME NMA_AMBER_MMP_energy_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMBER_MMP_energy_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/ENE_1_WANG_AL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME NMA_AMBER_MMP_energy_EF_1_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/NMA_AMBER_MMP_HDF5.json
                          Testing/NMA_AMBER_MMP_energy_EF_1.out_HDF5 tests/N-methylacetamide/EF_1.txt)
add_test(NAME NMA_AMBER_MMP_energy_EF_1_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMBER_MMP_energy_EF_1.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/ENE_1_WANG_AL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME NMA_AMOEBA_XYZ_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_xyz.json
                          Testing/NMA_AMOEBA_XYZ_energy.out )
add_test(NAME NMA_AMOEBA_XYZ_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMOEBA_XYZ_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/FULL_POTENTIAL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME NMA_AMOEBA_XYZ_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/NMA_AMOEBA_XYZ_HDF5.json
                          Testing/NMA_AMOEBA_XYZ_energy.out_HDF5 )
add_test(NAME NMA_AMOEBA_XYZ_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/NMA_AMOEBA_XYZ_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/FULL_POTENTIAL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME NMA_AMOEBA_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_mmp.json
                          Testing/NMA_AMOEBA_MMP_ipd.out )
add_test(NAME NMA_AMOEBA_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/NMA_AMOEBA_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/IPD_0_AMOEBA.ref
                           1e-06  1e-05)
add_test(NAME NMA_AMOEBA_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_mmp.json
                          Testing/NMA_AMOEBA_MMP_ipd_EF_1.out tests/N-methylacetamide/EF_1.txt)
add_test(NAME NMA_AMOEBA_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/NMA_AMOEBA_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/IPD_1_AMOEBA.ref
                           1e-06  1e-05)
if (WITH_HDF5)
                    add_test(NAME NMACUT_AMOEBA_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amoeba_mmp.json Testing/NMACUT_AMOEBA_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME NMACUT_AMOEBA_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amoeba_mmp.json
                          Testing/NMACUT_AMOEBA_MMP_ipd.out )
add_test(NAME NMACUT_AMOEBA_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/NMACUT_AMOEBA_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/IPD_0_AMOEBA_CUT.ref
                           1e-06  1e-05)
add_test(NAME NMACUT_AMOEBA_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amoeba_mmp.json
                          Testing/NMACUT_AMOEBA_MMP_ipd_EF_1.out tests/N-methylacetamide/EF_1.txt)
add_test(NAME NMACUT_AMOEBA_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/NMACUT_AMOEBA_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/IPD_1_AMOEBA_CUT.ref
                           1e-06  1e-05)
add_test(NAME NMA_AMBER_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amber_mmp.json
                          Testing/NMA_AMBER_MMP_ipd.out )
add_test(NAME NMA_AMBER_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/NMA_AMBER_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/IPD_0_WANG_AL.ref
                           1e-06  1e-05)
add_test(NAME NMA_AMBER_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amber_mmp.json
                          Testing/NMA_AMBER_MMP_ipd_EF_1.out tests/N-methylacetamide/EF_1.txt)
add_test(NAME NMA_AMBER_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/NMA_AMBER_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/IPD_1_WANG_AL.ref
                           1e-06  1e-05)
if (WITH_HDF5)
                    add_test(NAME NMACUT_AMBER_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amber_mmp.json Testing/NMACUT_AMBER_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME NMACUT_AMBER_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amber_mmp.json
                          Testing/NMACUT_AMBER_MMP_ipd.out )
add_test(NAME NMACUT_AMBER_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/NMACUT_AMBER_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/IPD_0_WANG_AL_CUT.ref
                           1e-06  1e-05)
add_test(NAME NMACUT_AMBER_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amber_mmp.json
                          Testing/NMACUT_AMBER_MMP_ipd_EF_1.out tests/N-methylacetamide/EF_1.txt)
add_test(NAME NMACUT_AMBER_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/NMACUT_AMBER_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/N-methylacetamide/IPD_1_WANG_AL_CUT.ref
                           1e-06  1e-05)
add_test(NAME NMA_AMOEBA_MMP_geomgrad_num
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_mmp.json
                          Testing/NMA_AMOEBA_MMP_geomgrad_num.out)
add_test(NAME NMA_AMOEBA_MMP_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_mmp.json
                          Testing/NMA_AMOEBA_MMP_geomgrad_ana.out)
add_test(NAME NMA_AMOEBA_MMP_geomgrad_comp_num_ana
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMA_AMOEBA_MMP_geomgrad_num.out
                          Testing/NMA_AMOEBA_MMP_geomgrad_ana.out
                           0.001 0.0001)
if (WITH_HDF5)
add_test(NAME NMA_AMOEBA_MMP_geomgrad_num_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          Testing/NMA_AMOEBA_MMP_HDF5.json
                          Testing/NMA_AMOEBA_MMP_geomgrad_num.out_HDF5)
add_test(NAME NMA_AMOEBA_MMP_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/NMA_AMOEBA_MMP_HDF5.json
                          Testing/NMA_AMOEBA_MMP_geomgrad_ana.out_HDF5)
add_test(NAME NMA_AMOEBA_MMP_geomgrad_comp_num_ana_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMA_AMOEBA_MMP_geomgrad_num.out_HDF5
                          Testing/NMA_AMOEBA_MMP_geomgrad_ana.out_HDF5
                           0.001 0.0001)
endif ()
add_test(NAME NMACUT_AMOEBA_MMP_geomgrad_num
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amoeba_mmp.json
                          Testing/NMACUT_AMOEBA_MMP_geomgrad_num.out)
add_test(NAME NMACUT_AMOEBA_MMP_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amoeba_mmp.json
                          Testing/NMACUT_AMOEBA_MMP_geomgrad_ana.out)
add_test(NAME NMACUT_AMOEBA_MMP_geomgrad_comp_num_ana
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMACUT_AMOEBA_MMP_geomgrad_num.out
                          Testing/NMACUT_AMOEBA_MMP_geomgrad_ana.out
                           0.001 0.0001)
if (WITH_HDF5)
add_test(NAME NMACUT_AMOEBA_MMP_geomgrad_num_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          Testing/NMACUT_AMOEBA_MMP_HDF5.json
                          Testing/NMACUT_AMOEBA_MMP_geomgrad_num.out_HDF5)
add_test(NAME NMACUT_AMOEBA_MMP_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/NMACUT_AMOEBA_MMP_HDF5.json
                          Testing/NMACUT_AMOEBA_MMP_geomgrad_ana.out_HDF5)
add_test(NAME NMACUT_AMOEBA_MMP_geomgrad_comp_num_ana_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMACUT_AMOEBA_MMP_geomgrad_num.out_HDF5
                          Testing/NMACUT_AMOEBA_MMP_geomgrad_ana.out_HDF5
                           0.001 0.0001)
endif ()
add_test(NAME NMA_AMBER_MMP_geomgrad_num
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amber_mmp.json
                          Testing/NMA_AMBER_MMP_geomgrad_num.out)
add_test(NAME NMA_AMBER_MMP_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amber_mmp.json
                          Testing/NMA_AMBER_MMP_geomgrad_ana.out)
add_test(NAME NMA_AMBER_MMP_geomgrad_comp_num_ana
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMA_AMBER_MMP_geomgrad_num.out
                          Testing/NMA_AMBER_MMP_geomgrad_ana.out
                           0.001 0.0001)
if (WITH_HDF5)
add_test(NAME NMA_AMBER_MMP_geomgrad_num_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          Testing/NMA_AMBER_MMP_HDF5.json
                          Testing/NMA_AMBER_MMP_geomgrad_num.out_HDF5)
add_test(NAME NMA_AMBER_MMP_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/NMA_AMBER_MMP_HDF5.json
                          Testing/NMA_AMBER_MMP_geomgrad_ana.out_HDF5)
add_test(NAME NMA_AMBER_MMP_geomgrad_comp_num_ana_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMA_AMBER_MMP_geomgrad_num.out_HDF5
                          Testing/NMA_AMBER_MMP_geomgrad_ana.out_HDF5
                           0.001 0.0001)
endif ()
add_test(NAME NMACUT_AMBER_MMP_geomgrad_num
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amber_mmp.json
                          Testing/NMACUT_AMBER_MMP_geomgrad_num.out)
add_test(NAME NMACUT_AMBER_MMP_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/NMA_cut_amber_mmp.json
                          Testing/NMACUT_AMBER_MMP_geomgrad_ana.out)
add_test(NAME NMACUT_AMBER_MMP_geomgrad_comp_num_ana
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMACUT_AMBER_MMP_geomgrad_num.out
                          Testing/NMACUT_AMBER_MMP_geomgrad_ana.out
                           0.001 0.0001)
if (WITH_HDF5)
add_test(NAME NMACUT_AMBER_MMP_geomgrad_num_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          Testing/NMACUT_AMBER_MMP_HDF5.json
                          Testing/NMACUT_AMBER_MMP_geomgrad_num.out_HDF5)
add_test(NAME NMACUT_AMBER_MMP_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/NMACUT_AMBER_MMP_HDF5.json
                          Testing/NMACUT_AMBER_MMP_geomgrad_ana.out_HDF5)
add_test(NAME NMACUT_AMBER_MMP_geomgrad_comp_num_ana_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMACUT_AMBER_MMP_geomgrad_num.out_HDF5
                          Testing/NMACUT_AMBER_MMP_geomgrad_ana.out_HDF5
                           0.001 0.0001)
endif ()
add_test(NAME NMA_AMOEBA_XYZ_geomgrad_num
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_xyz.json
                          Testing/NMA_AMOEBA_XYZ_geomgrad_num.out)
add_test(NAME NMA_AMOEBA_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/NMA_amoeba_xyz.json
                          Testing/NMA_AMOEBA_XYZ_geomgrad_ana.out)
add_test(NAME NMA_AMOEBA_XYZ_geomgrad_comp_num_ana
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMA_AMOEBA_XYZ_geomgrad_num.out
                          Testing/NMA_AMOEBA_XYZ_geomgrad_ana.out
                           0.001 0.0001)
if (WITH_HDF5)
add_test(NAME NMA_AMOEBA_XYZ_geomgrad_num_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          Testing/NMA_AMOEBA_XYZ_HDF5.json
                          Testing/NMA_AMOEBA_XYZ_geomgrad_num.out_HDF5)
add_test(NAME NMA_AMOEBA_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/NMA_AMOEBA_XYZ_HDF5.json
                          Testing/NMA_AMOEBA_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME NMA_AMOEBA_XYZ_geomgrad_comp_num_ana_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/NMA_AMOEBA_XYZ_geomgrad_num.out_HDF5
                          Testing/NMA_AMOEBA_XYZ_geomgrad_ana.out_HDF5
                           0.001 0.0001)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1CRN_AMBER_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1crn_amber_mmp.json Testing/1CRN_AMBER_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1CRN_AMBER_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amber_mmp.json
                          Testing/1CRN_AMBER_MMP_init.out)
add_test(NAME 1CRN_AMBER_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1CRN_AMBER_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/summary_WANG_AL.ref)
if (WITH_HDF5)
add_test(NAME 1CRN_AMBER_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1CRN_AMBER_MMP_HDF5.json
                          Testing/1CRN_AMBER_MMP_init.out_HDF5)
add_test(NAME 1CRN_AMBER_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1CRN_AMBER_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/summary_WANG_AL.ref)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1CRN_AMOEBA_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_mmp.json Testing/1CRN_AMOEBA_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1CRN_AMOEBA_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_mmp.json
                          Testing/1CRN_AMOEBA_MMP_init.out)
add_test(NAME 1CRN_AMOEBA_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1CRN_AMOEBA_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/summary_AMOEBA.ref)
if (WITH_HDF5)
add_test(NAME 1CRN_AMOEBA_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1CRN_AMOEBA_MMP_HDF5.json
                          Testing/1CRN_AMOEBA_MMP_init.out_HDF5)
add_test(NAME 1CRN_AMOEBA_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1CRN_AMOEBA_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/summary_AMOEBA.ref)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1CRN_AMOEBA_XYZ_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_xyz.json Testing/1CRN_AMOEBA_XYZ_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1CRN_AMOEBA_XYZ_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_xyz.json
                          Testing/1CRN_AMOEBA_XYZ_init.out)
add_test(NAME 1CRN_AMOEBA_XYZ_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1CRN_AMOEBA_XYZ_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/summary_AMOEBA.ref)
if (WITH_HDF5)
add_test(NAME 1CRN_AMOEBA_XYZ_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1CRN_AMOEBA_XYZ_HDF5.json
                          Testing/1CRN_AMOEBA_XYZ_init.out_HDF5)
add_test(NAME 1CRN_AMOEBA_XYZ_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1CRN_AMOEBA_XYZ_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/summary_AMOEBA.ref)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1CRN_AMBER_XYZ_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1crn_amber_xyz.json Testing/1CRN_AMBER_XYZ_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1CRN_AMBER_XYZ_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amber_xyz.json
                          Testing/1CRN_AMBER_XYZ_init.out)
add_test(NAME 1CRN_AMBER_XYZ_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1CRN_AMBER_XYZ_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/summary_AMBER99SB.ref)
if (WITH_HDF5)
add_test(NAME 1CRN_AMBER_XYZ_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1CRN_AMBER_XYZ_HDF5.json
                          Testing/1CRN_AMBER_XYZ_init.out_HDF5)
add_test(NAME 1CRN_AMBER_XYZ_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1CRN_AMBER_XYZ_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/summary_AMBER99SB.ref)
endif ()
add_test(NAME 1CRN_AMBER_MMP_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amber_mmp.json
                          Testing/1CRN_AMBER_MMP_energy.out )
add_test(NAME 1CRN_AMBER_MMP_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMBER_MMP_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/ENE_0_WANG_AL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1CRN_AMBER_MMP_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1CRN_AMBER_MMP_HDF5.json
                          Testing/1CRN_AMBER_MMP_energy.out_HDF5 )
add_test(NAME 1CRN_AMBER_MMP_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMBER_MMP_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/ENE_0_WANG_AL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1CRN_AMBER_MMP_energy_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amber_mmp.json
                          Testing/1CRN_AMBER_MMP_energy_EF_1.out tests/1crn/EF_1.txt)
add_test(NAME 1CRN_AMBER_MMP_energy_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMBER_MMP_energy_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/ENE_1_WANG_AL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1CRN_AMBER_MMP_energy_EF_1_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1CRN_AMBER_MMP_HDF5.json
                          Testing/1CRN_AMBER_MMP_energy_EF_1.out_HDF5 tests/1crn/EF_1.txt)
add_test(NAME 1CRN_AMBER_MMP_energy_EF_1_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMBER_MMP_energy_EF_1.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/ENE_1_WANG_AL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1CRN_AMOEBA_MMP_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_mmp.json
                          Testing/1CRN_AMOEBA_MMP_energy.out )
add_test(NAME 1CRN_AMOEBA_MMP_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMOEBA_MMP_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/ENE_0_AMOEBA.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1CRN_AMOEBA_MMP_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1CRN_AMOEBA_MMP_HDF5.json
                          Testing/1CRN_AMOEBA_MMP_energy.out_HDF5 )
add_test(NAME 1CRN_AMOEBA_MMP_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMOEBA_MMP_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/ENE_0_AMOEBA.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1CRN_AMOEBA_MMP_energy_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_mmp.json
                          Testing/1CRN_AMOEBA_MMP_energy_EF_1.out tests/1crn/EF_1.txt)
add_test(NAME 1CRN_AMOEBA_MMP_energy_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMOEBA_MMP_energy_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/ENE_1_AMOEBA.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1CRN_AMOEBA_MMP_energy_EF_1_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1CRN_AMOEBA_MMP_HDF5.json
                          Testing/1CRN_AMOEBA_MMP_energy_EF_1.out_HDF5 tests/1crn/EF_1.txt)
add_test(NAME 1CRN_AMOEBA_MMP_energy_EF_1_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMOEBA_MMP_energy_EF_1.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/ENE_1_AMOEBA.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1CRN_AMOEBA_XYZ_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_xyz.json
                          Testing/1CRN_AMOEBA_XYZ_energy.out )
add_test(NAME 1CRN_AMOEBA_XYZ_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMOEBA_XYZ_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/FULL_POTENTIAL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1CRN_AMOEBA_XYZ_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1CRN_AMOEBA_XYZ_HDF5.json
                          Testing/1CRN_AMOEBA_XYZ_energy.out_HDF5 )
add_test(NAME 1CRN_AMOEBA_XYZ_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMOEBA_XYZ_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/FULL_POTENTIAL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1CRN_AMBER_XYZ_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amber_xyz.json
                          Testing/1CRN_AMBER_XYZ_energy.out )
add_test(NAME 1CRN_AMBER_XYZ_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMBER_XYZ_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/FULL_POTENTIAL_AMBER99SB.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1CRN_AMBER_XYZ_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1CRN_AMBER_XYZ_HDF5.json
                          Testing/1CRN_AMBER_XYZ_energy.out_HDF5 )
add_test(NAME 1CRN_AMBER_XYZ_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1CRN_AMBER_XYZ_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1crn/FULL_POTENTIAL_AMBER99SB.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1CRN_AMBER_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amber_mmp.json
                          Testing/1CRN_AMBER_MMP_ipd.out )
add_test(NAME 1CRN_AMBER_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1CRN_AMBER_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/IPD_0_WANG_AL.ref
                           1e-06  1e-05)
add_test(NAME 1CRN_AMBER_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amber_mmp.json
                          Testing/1CRN_AMBER_MMP_ipd_EF_1.out tests/1crn/EF_1.txt)
add_test(NAME 1CRN_AMBER_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1CRN_AMBER_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/IPD_1_WANG_AL.ref
                           1e-06  1e-05)
add_test(NAME 1CRN_AMOEBA_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_mmp.json
                          Testing/1CRN_AMOEBA_MMP_ipd.out )
add_test(NAME 1CRN_AMOEBA_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1CRN_AMOEBA_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/IPD_0_AMOEBA.ref
                           1e-06  1e-05)
add_test(NAME 1CRN_AMOEBA_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_mmp.json
                          Testing/1CRN_AMOEBA_MMP_ipd_EF_1.out tests/1crn/EF_1.txt)
add_test(NAME 1CRN_AMOEBA_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1CRN_AMOEBA_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1crn/IPD_1_AMOEBA.ref
                           1e-06  1e-05)
add_test(NAME 1CRN_AMOEBA_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amoeba_xyz.json
                          Testing/1CRN_AMOEBA_XYZ_geomgrad_ana.out)
add_test(NAME 1CRN_AMOEBA_XYZ_geomgrad_comp_ana_ref
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1CRN_AMOEBA_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1crn/FULL_POTENTIAL.ref
                         0.001 0.0001)
if (WITH_HDF5)
add_test(NAME 1CRN_AMOEBA_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/1CRN_AMOEBA_XYZ_HDF5.json
                          Testing/1CRN_AMOEBA_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME 1CRN_AMOEBA_XYZ_geomgrad_comp_ana_ref_HDF5
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1CRN_AMOEBA_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1crn/FULL_POTENTIAL.ref
                         0.001 0.0001)
endif ()
add_test(NAME 1CRN_AMBER_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/1crn_amber_xyz.json
                          Testing/1CRN_AMBER_XYZ_geomgrad_ana.out)
add_test(NAME 1CRN_AMBER_XYZ_geomgrad_comp_ana_ref
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1CRN_AMBER_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1crn/FULL_POTENTIAL_AMBER99SB.ref
                         0.001 0.0001)
if (WITH_HDF5)
add_test(NAME 1CRN_AMBER_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/1CRN_AMBER_XYZ_HDF5.json
                          Testing/1CRN_AMBER_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME 1CRN_AMBER_XYZ_geomgrad_comp_ana_ref_HDF5
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1CRN_AMBER_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1crn/FULL_POTENTIAL_AMBER99SB.ref
                         0.001 0.0001)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1UBQ_AMBER_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1ubq_amber_mmp.json Testing/1UBQ_AMBER_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1UBQ_AMBER_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amber_mmp.json
                          Testing/1UBQ_AMBER_MMP_init.out)
add_test(NAME 1UBQ_AMBER_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1UBQ_AMBER_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/summary_WANG_AL.ref)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMBER_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1UBQ_AMBER_MMP_HDF5.json
                          Testing/1UBQ_AMBER_MMP_init.out_HDF5)
add_test(NAME 1UBQ_AMBER_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1UBQ_AMBER_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/summary_WANG_AL.ref)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1UBQ_AMOEBA_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_mmp.json Testing/1UBQ_AMOEBA_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1UBQ_AMOEBA_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_mmp.json
                          Testing/1UBQ_AMOEBA_MMP_init.out)
add_test(NAME 1UBQ_AMOEBA_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1UBQ_AMOEBA_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/summary_AMOEBA.ref)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMOEBA_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1UBQ_AMOEBA_MMP_HDF5.json
                          Testing/1UBQ_AMOEBA_MMP_init.out_HDF5)
add_test(NAME 1UBQ_AMOEBA_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1UBQ_AMOEBA_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/summary_AMOEBA.ref)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1UBQ_AMOEBA_XYZ_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_xyz.json Testing/1UBQ_AMOEBA_XYZ_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1UBQ_AMOEBA_XYZ_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_xyz.json
                          Testing/1UBQ_AMOEBA_XYZ_init.out)
add_test(NAME 1UBQ_AMOEBA_XYZ_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1UBQ_AMOEBA_XYZ_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/summary_AMOEBA.ref)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMOEBA_XYZ_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1UBQ_AMOEBA_XYZ_HDF5.json
                          Testing/1UBQ_AMOEBA_XYZ_init.out_HDF5)
add_test(NAME 1UBQ_AMOEBA_XYZ_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1UBQ_AMOEBA_XYZ_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/summary_AMOEBA.ref)
endif ()
add_test(NAME 1UBQ_AMBER_MMP_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amber_mmp.json
                          Testing/1UBQ_AMBER_MMP_energy.out )
add_test(NAME 1UBQ_AMBER_MMP_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMBER_MMP_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/ENE_0_WANG_AL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMBER_MMP_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1UBQ_AMBER_MMP_HDF5.json
                          Testing/1UBQ_AMBER_MMP_energy.out_HDF5 )
add_test(NAME 1UBQ_AMBER_MMP_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMBER_MMP_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/ENE_0_WANG_AL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1UBQ_AMBER_MMP_energy_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amber_mmp.json
                          Testing/1UBQ_AMBER_MMP_energy_EF_1.out tests/1ubq/EF_1.txt)
add_test(NAME 1UBQ_AMBER_MMP_energy_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMBER_MMP_energy_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/ENE_1_WANG_AL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMBER_MMP_energy_EF_1_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1UBQ_AMBER_MMP_HDF5.json
                          Testing/1UBQ_AMBER_MMP_energy_EF_1.out_HDF5 tests/1ubq/EF_1.txt)
add_test(NAME 1UBQ_AMBER_MMP_energy_EF_1_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMBER_MMP_energy_EF_1.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/ENE_1_WANG_AL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1UBQ_AMOEBA_MMP_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_mmp.json
                          Testing/1UBQ_AMOEBA_MMP_energy.out )
add_test(NAME 1UBQ_AMOEBA_MMP_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMOEBA_MMP_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/ENE_0_AMOEBA.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMOEBA_MMP_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1UBQ_AMOEBA_MMP_HDF5.json
                          Testing/1UBQ_AMOEBA_MMP_energy.out_HDF5 )
add_test(NAME 1UBQ_AMOEBA_MMP_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMOEBA_MMP_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/ENE_0_AMOEBA.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1UBQ_AMOEBA_MMP_energy_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_mmp.json
                          Testing/1UBQ_AMOEBA_MMP_energy_EF_1.out tests/1ubq/EF_1.txt)
add_test(NAME 1UBQ_AMOEBA_MMP_energy_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMOEBA_MMP_energy_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/ENE_1_AMOEBA.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMOEBA_MMP_energy_EF_1_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1UBQ_AMOEBA_MMP_HDF5.json
                          Testing/1UBQ_AMOEBA_MMP_energy_EF_1.out_HDF5 tests/1ubq/EF_1.txt)
add_test(NAME 1UBQ_AMOEBA_MMP_energy_EF_1_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMOEBA_MMP_energy_EF_1.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/ENE_1_AMOEBA.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1UBQ_AMOEBA_XYZ_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_xyz.json
                          Testing/1UBQ_AMOEBA_XYZ_energy.out )
add_test(NAME 1UBQ_AMOEBA_XYZ_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMOEBA_XYZ_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/FULL_POTENTIAL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMOEBA_XYZ_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1UBQ_AMOEBA_XYZ_HDF5.json
                          Testing/1UBQ_AMOEBA_XYZ_energy.out_HDF5 )
add_test(NAME 1UBQ_AMOEBA_XYZ_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMOEBA_XYZ_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/FULL_POTENTIAL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1UBQ_AMBER_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amber_mmp.json
                          Testing/1UBQ_AMBER_MMP_ipd.out )
add_test(NAME 1UBQ_AMBER_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1UBQ_AMBER_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/IPD_0_WANG_AL.ref
                           1e-06  1e-05)
add_test(NAME 1UBQ_AMBER_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amber_mmp.json
                          Testing/1UBQ_AMBER_MMP_ipd_EF_1.out tests/1ubq/EF_1.txt)
add_test(NAME 1UBQ_AMBER_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1UBQ_AMBER_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/IPD_1_WANG_AL.ref
                           1e-06  1e-05)
add_test(NAME 1UBQ_AMOEBA_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_mmp.json
                          Testing/1UBQ_AMOEBA_MMP_ipd.out )
add_test(NAME 1UBQ_AMOEBA_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1UBQ_AMOEBA_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/IPD_0_AMOEBA.ref
                           1e-06  1e-05)
add_test(NAME 1UBQ_AMOEBA_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_mmp.json
                          Testing/1UBQ_AMOEBA_MMP_ipd_EF_1.out tests/1ubq/EF_1.txt)
add_test(NAME 1UBQ_AMOEBA_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1UBQ_AMOEBA_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/IPD_1_AMOEBA.ref
                           1e-06  1e-05)
add_test(NAME 1UBQ_AMOEBA_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_xyz.json
                          Testing/1UBQ_AMOEBA_XYZ_geomgrad_ana.out)
add_test(NAME 1UBQ_AMOEBA_XYZ_geomgrad_comp_ana_ref
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1UBQ_AMOEBA_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1ubq/FULL_POTENTIAL.ref
                         0.001 0.0001)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMOEBA_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/1UBQ_AMOEBA_XYZ_HDF5.json
                          Testing/1UBQ_AMOEBA_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME 1UBQ_AMOEBA_XYZ_geomgrad_comp_ana_ref_HDF5
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1UBQ_AMOEBA_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1ubq/FULL_POTENTIAL.ref
                         0.001 0.0001)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1UBQ_AMOEBA_XYZ_LS_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_xyz_LS.json Testing/1UBQ_AMOEBA_XYZ_LS_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1UBQ_AMOEBA_XYZ_LS_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_xyz_LS.json
                          Testing/1UBQ_AMOEBA_XYZ_LS_energy.out )
add_test(NAME 1UBQ_AMOEBA_XYZ_LS_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMOEBA_XYZ_LS_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/FULL_POTENTIAL_LS.ref
                           1e-05  1e-05)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMOEBA_XYZ_LS_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1UBQ_AMOEBA_XYZ_LS_HDF5.json
                          Testing/1UBQ_AMOEBA_XYZ_LS_energy.out_HDF5 )
add_test(NAME 1UBQ_AMOEBA_XYZ_LS_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1UBQ_AMOEBA_XYZ_LS_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ubq/FULL_POTENTIAL_LS.ref
                           1e-05  1e-05)
endif ()
add_test(NAME 1UBQ_AMOEBA_XYZ_LS_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/1ubq_amoeba_xyz_LS.json
                          Testing/1UBQ_AMOEBA_XYZ_LS_geomgrad_ana.out)
add_test(NAME 1UBQ_AMOEBA_XYZ_LS_geomgrad_comp_ana_ref
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1UBQ_AMOEBA_XYZ_LS_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1ubq/FULL_POTENTIAL_LS.ref
                         0.001 0.0001)
if (WITH_HDF5)
add_test(NAME 1UBQ_AMOEBA_XYZ_LS_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/1UBQ_AMOEBA_XYZ_LS_HDF5.json
                          Testing/1UBQ_AMOEBA_XYZ_LS_geomgrad_ana.out_HDF5)
add_test(NAME 1UBQ_AMOEBA_XYZ_LS_geomgrad_comp_ana_ref_HDF5
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1UBQ_AMOEBA_XYZ_LS_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1ubq/FULL_POTENTIAL_LS.ref
                         0.001 0.0001)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1AO6_AMBER_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1ao6_amber_mmp.json Testing/1AO6_AMBER_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1AO6_AMBER_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_amber_mmp.json
                          Testing/1AO6_AMBER_MMP_init.out)
add_test(NAME 1AO6_AMBER_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6_AMBER_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_WANG_AL.ref)
if (WITH_HDF5)
add_test(NAME 1AO6_AMBER_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1AO6_AMBER_MMP_HDF5.json
                          Testing/1AO6_AMBER_MMP_init.out_HDF5)
add_test(NAME 1AO6_AMBER_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6_AMBER_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_WANG_AL.ref)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1AO6CUT_AMBER_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amber_mmp.json Testing/1AO6CUT_AMBER_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1AO6CUT_AMBER_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amber_mmp.json
                          Testing/1AO6CUT_AMBER_MMP_init.out)
add_test(NAME 1AO6CUT_AMBER_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6CUT_AMBER_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_WANG_AL_CUT10.ref)
if (WITH_HDF5)
add_test(NAME 1AO6CUT_AMBER_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1AO6CUT_AMBER_MMP_HDF5.json
                          Testing/1AO6CUT_AMBER_MMP_init.out_HDF5)
add_test(NAME 1AO6CUT_AMBER_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6CUT_AMBER_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_WANG_AL_CUT10.ref)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1AO6_AMOEBA_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1ao6_amoeba_mmp.json Testing/1AO6_AMOEBA_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1AO6_AMOEBA_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_amoeba_mmp.json
                          Testing/1AO6_AMOEBA_MMP_init.out)
add_test(NAME 1AO6_AMOEBA_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6_AMOEBA_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_AMOEBA.ref)
if (WITH_HDF5)
add_test(NAME 1AO6_AMOEBA_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1AO6_AMOEBA_MMP_HDF5.json
                          Testing/1AO6_AMOEBA_MMP_init.out_HDF5)
add_test(NAME 1AO6_AMOEBA_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6_AMOEBA_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_AMOEBA.ref)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1AO6CUT_AMOEBA_MMP_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amoeba_mmp.json Testing/1AO6CUT_AMOEBA_MMP_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1AO6CUT_AMOEBA_MMP_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amoeba_mmp.json
                          Testing/1AO6CUT_AMOEBA_MMP_init.out)
add_test(NAME 1AO6CUT_AMOEBA_MMP_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6CUT_AMOEBA_MMP_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_AMOEBA_CUT10.ref)
if (WITH_HDF5)
add_test(NAME 1AO6CUT_AMOEBA_MMP_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1AO6CUT_AMOEBA_MMP_HDF5.json
                          Testing/1AO6CUT_AMOEBA_MMP_init.out_HDF5)
add_test(NAME 1AO6CUT_AMOEBA_MMP_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6CUT_AMOEBA_MMP_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_AMOEBA_CUT10.ref)
endif ()
if (WITH_HDF5)
                    add_test(NAME 1AO6_AMOEBA_XYZ_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/1ao6_amoeba_xyz.json Testing/1AO6_AMOEBA_XYZ_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 1AO6_AMOEBA_XYZ_init
                          COMMAND bin/${TESTLANG}_test_SI_init
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_amoeba_xyz.json
                          Testing/1AO6_AMOEBA_XYZ_init.out)
add_test(NAME 1AO6_AMOEBA_XYZ_init_comp
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6_AMOEBA_XYZ_init.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_AMOEBA.ref)
if (WITH_HDF5)
add_test(NAME 1AO6_AMOEBA_XYZ_init_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_init
                          Testing/1AO6_AMOEBA_XYZ_HDF5.json
                          Testing/1AO6_AMOEBA_XYZ_init.out_HDF5)
add_test(NAME 1AO6_AMOEBA_XYZ_init_comp_HDF5
                          COMMAND ${CMAKE_COMMAND} -E compare_files
                          Testing/1AO6_AMOEBA_XYZ_init.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/summary_AMOEBA.ref)
endif ()
add_test(NAME 1AO6CUT_AMBER_MMP_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amber_mmp.json
                          Testing/1AO6CUT_AMBER_MMP_energy.out )
add_test(NAME 1AO6CUT_AMBER_MMP_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6CUT_AMBER_MMP_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/ENE_0_WANG_AL_CUT10.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1AO6CUT_AMBER_MMP_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1AO6CUT_AMBER_MMP_HDF5.json
                          Testing/1AO6CUT_AMBER_MMP_energy.out_HDF5 )
add_test(NAME 1AO6CUT_AMBER_MMP_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6CUT_AMBER_MMP_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/ENE_0_WANG_AL_CUT10.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1AO6CUT_AMBER_MMP_energy_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amber_mmp.json
                          Testing/1AO6CUT_AMBER_MMP_energy_EF_1.out tests/1ao6/EF_1.txt)
add_test(NAME 1AO6CUT_AMBER_MMP_energy_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6CUT_AMBER_MMP_energy_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/ENE_1_WANG_AL_CUT10.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1AO6CUT_AMBER_MMP_energy_EF_1_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1AO6CUT_AMBER_MMP_HDF5.json
                          Testing/1AO6CUT_AMBER_MMP_energy_EF_1.out_HDF5 tests/1ao6/EF_1.txt)
add_test(NAME 1AO6CUT_AMBER_MMP_energy_EF_1_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6CUT_AMBER_MMP_energy_EF_1.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/ENE_1_WANG_AL_CUT10.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1AO6CUT_AMOEBA_MMP_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amoeba_mmp.json
                          Testing/1AO6CUT_AMOEBA_MMP_energy.out )
add_test(NAME 1AO6CUT_AMOEBA_MMP_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6CUT_AMOEBA_MMP_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/ENE_0_AMOEBA_CUT10.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1AO6CUT_AMOEBA_MMP_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1AO6CUT_AMOEBA_MMP_HDF5.json
                          Testing/1AO6CUT_AMOEBA_MMP_energy.out_HDF5 )
add_test(NAME 1AO6CUT_AMOEBA_MMP_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6CUT_AMOEBA_MMP_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/ENE_0_AMOEBA_CUT10.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1AO6CUT_AMOEBA_MMP_energy_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amoeba_mmp.json
                          Testing/1AO6CUT_AMOEBA_MMP_energy_EF_1.out tests/1ao6/EF_1.txt)
add_test(NAME 1AO6CUT_AMOEBA_MMP_energy_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6CUT_AMOEBA_MMP_energy_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/ENE_1_AMOEBA_CUT10.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1AO6CUT_AMOEBA_MMP_energy_EF_1_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1AO6CUT_AMOEBA_MMP_HDF5.json
                          Testing/1AO6CUT_AMOEBA_MMP_energy_EF_1.out_HDF5 tests/1ao6/EF_1.txt)
add_test(NAME 1AO6CUT_AMOEBA_MMP_energy_EF_1_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6CUT_AMOEBA_MMP_energy_EF_1.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/ENE_1_AMOEBA_CUT10.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1AO6_AMOEBA_XYZ_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_amoeba_xyz.json
                          Testing/1AO6_AMOEBA_XYZ_energy.out )
add_test(NAME 1AO6_AMOEBA_XYZ_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6_AMOEBA_XYZ_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/FULL_POTENTIAL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 1AO6_AMOEBA_XYZ_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/1AO6_AMOEBA_XYZ_HDF5.json
                          Testing/1AO6_AMOEBA_XYZ_energy.out_HDF5 )
add_test(NAME 1AO6_AMOEBA_XYZ_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/1AO6_AMOEBA_XYZ_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/FULL_POTENTIAL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 1AO6CUT_AMBER_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amber_mmp.json
                          Testing/1AO6CUT_AMBER_MMP_ipd.out )
add_test(NAME 1AO6CUT_AMBER_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1AO6CUT_AMBER_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/IPD_0_WANG_AL_CUT10.ref
                           1e-06  1e-05)
add_test(NAME 1AO6CUT_AMBER_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amber_mmp.json
                          Testing/1AO6CUT_AMBER_MMP_ipd_EF_1.out tests/1ao6/EF_1.txt)
add_test(NAME 1AO6CUT_AMBER_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1AO6CUT_AMBER_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/IPD_1_WANG_AL_CUT10.ref
                           1e-06  1e-05)
add_test(NAME 1AO6CUT_AMOEBA_MMP_ipd
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amoeba_mmp.json
                          Testing/1AO6CUT_AMOEBA_MMP_ipd.out )
add_test(NAME 1AO6CUT_AMOEBA_MMP_ipd_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1AO6CUT_AMOEBA_MMP_ipd.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/IPD_0_AMOEBA_CUT10.ref
                           1e-06  1e-05)
add_test(NAME 1AO6CUT_AMOEBA_MMP_ipd_EF_1
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_cut_amoeba_mmp.json
                          Testing/1AO6CUT_AMOEBA_MMP_ipd_EF_1.out tests/1ao6/EF_1.txt)
add_test(NAME 1AO6CUT_AMOEBA_MMP_ipd_EF_1_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_ipd.py
                          Testing/1AO6CUT_AMOEBA_MMP_ipd_EF_1.out
                          ${CMAKE_SOURCE_DIR}/tests/1ao6/IPD_1_AMOEBA_CUT10.ref
                           1e-06  1e-05)
add_test(NAME 1AO6_AMOEBA_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/1ao6_amoeba_xyz.json
                          Testing/1AO6_AMOEBA_XYZ_geomgrad_ana.out)
add_test(NAME 1AO6_AMOEBA_XYZ_geomgrad_comp_ana_ref
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1AO6_AMOEBA_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1ao6/FULL_POTENTIAL.ref
                         0.001 0.0001)
if (WITH_HDF5)
add_test(NAME 1AO6_AMOEBA_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/1AO6_AMOEBA_XYZ_HDF5.json
                          Testing/1AO6_AMOEBA_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME 1AO6_AMOEBA_XYZ_geomgrad_comp_ana_ref_HDF5
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/1AO6_AMOEBA_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/1ao6/FULL_POTENTIAL.ref
                         0.001 0.0001)
endif ()
if (WITH_HDF5)
                    add_test(NAME 2D94_AMOEBA_XYZ_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/2d94_amoeba_xyz.json Testing/2D94_AMOEBA_XYZ_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME 2D94_AMOEBA_XYZ_energy
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          ${CMAKE_SOURCE_DIR}/tests/2d94_amoeba_xyz.json
                          Testing/2D94_AMOEBA_XYZ_energy.out )
add_test(NAME 2D94_AMOEBA_XYZ_energy_comp
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/2D94_AMOEBA_XYZ_energy.out
                          ${CMAKE_SOURCE_DIR}/tests/2d94/FULL_POTENTIAL.ref
                           1e-06  1e-06)
if (WITH_HDF5)
add_test(NAME 2D94_AMOEBA_XYZ_energy_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_potential
                          Testing/2D94_AMOEBA_XYZ_HDF5.json
                          Testing/2D94_AMOEBA_XYZ_energy.out_HDF5 )
add_test(NAME 2D94_AMOEBA_XYZ_energy_comp_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_potential.py
                          Testing/2D94_AMOEBA_XYZ_energy.out_HDF5
                          ${CMAKE_SOURCE_DIR}/tests/2d94/FULL_POTENTIAL.ref
                           1e-06  1e-06)
endif ()
add_test(NAME 2D94_AMOEBA_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/2d94_amoeba_xyz.json
                          Testing/2D94_AMOEBA_XYZ_geomgrad_ana.out)
add_test(NAME 2D94_AMOEBA_XYZ_geomgrad_comp_ana_ref
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/2D94_AMOEBA_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/2d94/FULL_POTENTIAL.ref
                         0.001 0.0001)
if (WITH_HDF5)
add_test(NAME 2D94_AMOEBA_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/2D94_AMOEBA_XYZ_HDF5.json
                          Testing/2D94_AMOEBA_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME 2D94_AMOEBA_XYZ_geomgrad_comp_ana_ref_HDF5
                        COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                        Testing/2D94_AMOEBA_XYZ_geomgrad_ana.out
                        ${CMAKE_SOURCE_DIR}/tests/2d94/FULL_POTENTIAL.ref
                         0.001 0.0001)
endif ()
if (WITH_HDF5)
                    add_test(NAME ALACAP_AMOEBA_XYZ_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/alacap_amoeba_xyz.json Testing/ALACAP_AMOEBA_XYZ_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME ALACAP_AMOEBA_XYZ_geomgrad_num
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          ${CMAKE_SOURCE_DIR}/tests/alacap_amoeba_xyz.json
                          Testing/ALACAP_AMOEBA_XYZ_geomgrad_num.out)
add_test(NAME ALACAP_AMOEBA_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/alacap_amoeba_xyz.json
                          Testing/ALACAP_AMOEBA_XYZ_geomgrad_ana.out)
add_test(NAME ALACAP_AMOEBA_XYZ_geomgrad_comp_num_ana
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/ALACAP_AMOEBA_XYZ_geomgrad_num.out
                          Testing/ALACAP_AMOEBA_XYZ_geomgrad_ana.out
                           0.001 0.0001)
if (WITH_HDF5)
add_test(NAME ALACAP_AMOEBA_XYZ_geomgrad_num_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          Testing/ALACAP_AMOEBA_XYZ_HDF5.json
                          Testing/ALACAP_AMOEBA_XYZ_geomgrad_num.out_HDF5)
add_test(NAME ALACAP_AMOEBA_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/ALACAP_AMOEBA_XYZ_HDF5.json
                          Testing/ALACAP_AMOEBA_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME ALACAP_AMOEBA_XYZ_geomgrad_comp_num_ana_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/ALACAP_AMOEBA_XYZ_geomgrad_num.out_HDF5
                          Testing/ALACAP_AMOEBA_XYZ_geomgrad_ana.out_HDF5
                           0.001 0.0001)
endif ()
if (WITH_HDF5)
                    add_test(NAME TYRCAP_AMOEBA_XYZ_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/tyrcap_amoeba_xyz.json Testing/TYRCAP_AMOEBA_XYZ_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME TYRCAP_AMOEBA_XYZ_geomgrad_num
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          ${CMAKE_SOURCE_DIR}/tests/tyrcap_amoeba_xyz.json
                          Testing/TYRCAP_AMOEBA_XYZ_geomgrad_num.out)
add_test(NAME TYRCAP_AMOEBA_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/tyrcap_amoeba_xyz.json
                          Testing/TYRCAP_AMOEBA_XYZ_geomgrad_ana.out)
add_test(NAME TYRCAP_AMOEBA_XYZ_geomgrad_comp_num_ana
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/TYRCAP_AMOEBA_XYZ_geomgrad_num.out
                          Testing/TYRCAP_AMOEBA_XYZ_geomgrad_ana.out
                           0.001 0.0001)
if (WITH_HDF5)
add_test(NAME TYRCAP_AMOEBA_XYZ_geomgrad_num_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          Testing/TYRCAP_AMOEBA_XYZ_HDF5.json
                          Testing/TYRCAP_AMOEBA_XYZ_geomgrad_num.out_HDF5)
add_test(NAME TYRCAP_AMOEBA_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/TYRCAP_AMOEBA_XYZ_HDF5.json
                          Testing/TYRCAP_AMOEBA_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME TYRCAP_AMOEBA_XYZ_geomgrad_comp_num_ana_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/TYRCAP_AMOEBA_XYZ_geomgrad_num.out_HDF5
                          Testing/TYRCAP_AMOEBA_XYZ_geomgrad_ana.out_HDF5
                           0.001 0.0001)
endif ()
if (WITH_HDF5)
                    add_test(NAME TYR2CAP_AMOEBA_XYZ_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/tyr2cap_amoeba_xyz.json Testing/TYR2CAP_AMOEBA_XYZ_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME TYR2CAP_AMOEBA_XYZ_geomgrad_num
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          ${CMAKE_SOURCE_DIR}/tests/tyr2cap_amoeba_xyz.json
                          Testing/TYR2CAP_AMOEBA_XYZ_geomgrad_num.out)
add_test(NAME TYR2CAP_AMOEBA_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/tyr2cap_amoeba_xyz.json
                          Testing/TYR2CAP_AMOEBA_XYZ_geomgrad_ana.out)
add_test(NAME TYR2CAP_AMOEBA_XYZ_geomgrad_comp_num_ana
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/TYR2CAP_AMOEBA_XYZ_geomgrad_num.out
                          Testing/TYR2CAP_AMOEBA_XYZ_geomgrad_ana.out
                           0.001 0.0001)
if (WITH_HDF5)
add_test(NAME TYR2CAP_AMOEBA_XYZ_geomgrad_num_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          Testing/TYR2CAP_AMOEBA_XYZ_HDF5.json
                          Testing/TYR2CAP_AMOEBA_XYZ_geomgrad_num.out_HDF5)
add_test(NAME TYR2CAP_AMOEBA_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/TYR2CAP_AMOEBA_XYZ_HDF5.json
                          Testing/TYR2CAP_AMOEBA_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME TYR2CAP_AMOEBA_XYZ_geomgrad_comp_num_ana_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/TYR2CAP_AMOEBA_XYZ_geomgrad_num.out_HDF5
                          Testing/TYR2CAP_AMOEBA_XYZ_geomgrad_ana.out_HDF5
                           0.001 0.0001)
endif ()
if (WITH_HDF5)
                    add_test(NAME PNA4H2O_AMOEBA_XYZ_HDF5_convert
                            COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/convert_test_to_hdf5.py
                            ${CMAKE_SOURCE_DIR}/tests/pna_amoeba_mmp.json Testing/PNA4H2O_AMOEBA_XYZ_HDF5 ./app/ommp_pp)
                 endif ()
add_test(NAME PNA4H2O_AMOEBA_XYZ_geomgrad_num
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          ${CMAKE_SOURCE_DIR}/tests/pna_amoeba_mmp.json
                          Testing/PNA4H2O_AMOEBA_XYZ_geomgrad_num.out)
add_test(NAME PNA4H2O_AMOEBA_XYZ_geomgrad_ana
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          ${CMAKE_SOURCE_DIR}/tests/pna_amoeba_mmp.json
                          Testing/PNA4H2O_AMOEBA_XYZ_geomgrad_ana.out)
add_test(NAME PNA4H2O_AMOEBA_XYZ_geomgrad_comp_num_ana
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/PNA4H2O_AMOEBA_XYZ_geomgrad_num.out
                          Testing/PNA4H2O_AMOEBA_XYZ_geomgrad_ana.out
                           0.001 0.0001)
if (WITH_HDF5)
add_test(NAME PNA4H2O_AMOEBA_XYZ_geomgrad_num_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad_num
                          Testing/PNA4H2O_AMOEBA_XYZ_HDF5.json
                          Testing/PNA4H2O_AMOEBA_XYZ_geomgrad_num.out_HDF5)
add_test(NAME PNA4H2O_AMOEBA_XYZ_geomgrad_ana_HDF5
                          COMMAND bin/${TESTLANG}_test_SI_geomgrad
                          Testing/PNA4H2O_AMOEBA_XYZ_HDF5.json
                          Testing/PNA4H2O_AMOEBA_XYZ_geomgrad_ana.out_HDF5)
add_test(NAME PNA4H2O_AMOEBA_XYZ_geomgrad_comp_num_ana_HDF5
                          COMMAND python3 ${CMAKE_SOURCE_DIR}/tests/compare_geomgrad.py
                          Testing/PNA4H2O_AMOEBA_XYZ_geomgrad_num.out_HDF5
                          Testing/PNA4H2O_AMOEBA_XYZ_geomgrad_ana.out_HDF5
                           0.001 0.0001)
endif ()
